<!DOCTYPE html>
<html>
<head>
    <title>Image to QR Scanner</title>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
</head>
<body>
    <h1>Upload Image to Scan for SPXID</h1>
    <input type="file" id="imageInput" />
    <button onclick="processImage()">Scan Image</button>
    <p id="output"></p>
    <canvas id="qrCanvas"></canvas>
    <script>
        async function processImage() {
            const file = document.getElementById('imageInput').files[0];
            if (!file) return alert('Please upload an image!');
            
            const reader = new FileReader();
            reader.onload = async function () {
                const worker = Tesseract.createWorker();
                await worker.load();
                await worker.loadLanguage('eng');
                await worker.initialize('eng');
                const { data } = await worker.recognize(reader.result);
                const spxids = data.text.match(/SPXID\d+/g);
                if (spxids) {
                    document.getElementById('output').innerHTML = 'Found SPXIDs: ' + spxids.join(', ');
                    QRCode.toCanvas(document.getElementById('qrCanvas'), spxids.join(', '), function (error) {
                        if (error) console.error(error);
                        console.log('QR code generated successfully!');
                    });
                } else {
                    document.getElementById('output').innerHTML = 'No SPXID found!';
                }
                await worker.terminate();
            };
            reader.readAsDataURL(file);
        }
    </script>
</body>
</html>
